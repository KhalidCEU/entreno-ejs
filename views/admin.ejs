<!DOCTYPE html>
<html>
  <head>
    <%- include("header", {}) %>
    <title><%= title %></title>
    <link rel='stylesheet' href='/stylesheets/admin.css'/>
    <link rel='stylesheet' href='/stylesheets/style.css' />
  </head>
  <body>
    <h1 class="admin-title"><%= title %></h1>

    <table class="table">
        <th>Username</th>
        <th>Role</th>
        <th>Last Login</th>
        <th>Delete</th>

        <!-- Render admin userss first  -->

        <%  Object.values(users)
            .filter(user => user.role === 'admin')
            .forEach((user) => { %>

            <tr>
                <td><%= user.username %></td>
                <td><%= user.role %></td>
                <td><%= user.last_login  %></td>
            </tr>
        <% }); %>

        <!-- Render non admin users  -->

        <%  Object.values(users)
            .filter(user => user.role !== 'admin')
            .forEach((user) => {
        %>
            <tr>
                <td><%= user.username %></td>
                <td><%= user.role %></td>
                <td><%= user.last_login  %></td>
                <td>
                    <form method="post" action="/admin/deleteUser">
                        <input type="hidden" name="username" value="<%= user.username %>">
                        <button type="submit">
                            Delete <%= user.username %>
                        </button>
                    </form>
                </td>
            </tr>
        <% }); %>

        <% if (message) { %>
            <div class="alert">
                <%= message %>
            </div>
        <% } %>
    </table>
  </body>
</html>
